<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—ä¼ ç®—æ³•äº¤å‰å˜å¼‚å¯è§†åŒ–å­¦ä¹ å¹³å°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            padding: 20px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .visualization-area {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .panel-title {
            color: #667eea;
            margin-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        
        label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
            color: #555;
        }
        
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            width: 100%;
            margin: 8px 0;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .chromosome-container {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            width: 100%;
            text-align: center;
        }
        
        .chromosome {
            display: flex;
            justify-content: center;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        .gene {
            width: 40px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin: 0 3px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .gene.binary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .gene.permutation {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .gene.real {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }
        
        .gene.crossover-point {
            background: linear-gradient(135deg, #ffd700, #ffb347) !important;
            color: #333;
            animation: glow 1.5s infinite alternate;
        }
        
        .gene.mutation-point {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52) !important;
            color: white;
            animation: pulse 1.2s infinite;
        }
        
        .gene.selected {
            border: 3px solid #ffd700;
            transform: scale(1.1);
        }
        
        .gene.parent1 {
            box-shadow: inset 0 0 0 2px #3498db;
        }
        
        .gene.parent2 {
            box-shadow: inset 0 0 0 2px #e74c3c;
        }
        
        .gene.offspring {
            box-shadow: inset 0 0 0 2px #2ecc71;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 5px #ffd700; }
            to { box-shadow: 0 0 20px #ffd700, 0 0 30px #ffd700; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }
        
        .step {
            text-align: center;
            flex: 1;
            padding: 10px;
        }
        
        .step.active {
            background: rgba(102, 126, 234, 0.3);
            border-radius: 5px;
            font-weight: bold;
        }
        
        .info-box {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }
        
        .current-state {
            text-align: center;
            padding: 15px;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
            color: #ffd700;
        }
        
        .legend {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
        }
        
        .binary-legend { background: linear-gradient(135deg, #3498db, #2980b9); }
        .permutation-legend { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .real-legend { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .crossover-legend { background: linear-gradient(135deg, #ffd700, #ffb347); }
        .mutation-legend { background: linear-gradient(135deg, #ff6b6b, #ee5a52); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ§¬ é—ä¼ ç®—æ³•äº¤å‰å˜å¼‚å¯è§†åŒ–å­¦ä¹ å¹³å°</h1>
            <p class="subtitle">ä¸“æ³¨äºäº¤å‰å’Œå˜å¼‚æ“ä½œçš„äº¤äº’å¼å­¦ä¹ </p>
        </header>
        
        <div class="main-content">
            <div class="control-panel">
                <h2 class="panel-title">æ§åˆ¶é¢æ¿</h2>
                
                <label for="encodingType">ç¼–ç æ–¹å¼</label>
                <select id="encodingType">
                    <option value="binary">äºŒè¿›åˆ¶ç¼–ç  (0/1)</option>
                    <option value="permutation">æ’åˆ—ç¼–ç  (1-8åºåˆ—)</option>
                    <option value="real">å®æ•°ç¼–ç  (0-10æµ®ç‚¹æ•°)</option>
                </select>
                
                <label for="crossoverType">äº¤å‰æ–¹å¼</label>
                <select id="crossoverType">
                    <option value="single">å•ç‚¹äº¤å‰</option>
                    <option value="double">åŒç‚¹äº¤å‰</option>
                    <option value="uniform">å‡åŒ€äº¤å‰</option>
                </select>
                
                <button onclick="generateParents()">ğŸ”„ ç”Ÿæˆçˆ¶ä»£</button>
                <button onclick="performCrossover()" class="crossover-btn">âœ‚ï¸ æ‰§è¡Œäº¤å‰</button>
                <button onclick="performMutation()" class="mutation-btn">ğŸ² æ‰§è¡Œå˜å¼‚</button>
                <button onclick="resetAll()">ğŸ—‘ï¸ é‡ç½®</button>
                
                <div class="info-box">
                    <h3>äº¤å‰æ“ä½œè¯´æ˜</h3>
                    <p>å•ç‚¹äº¤å‰ï¼šåœ¨æŸ“è‰²ä½“ä¸Šéšæœºé€‰æ‹©ä¸€ä¸ªç‚¹ï¼Œäº¤æ¢ä¸¤ä¸ªçˆ¶ä»£ä¸ªä½“è¯¥ç‚¹åçš„åŸºå› </p>
                    <p>åŒç‚¹äº¤å‰ï¼šé€‰æ‹©ä¸¤ä¸ªç‚¹ï¼Œäº¤æ¢ä¸¤ç‚¹ä¹‹é—´çš„åŸºå› ç‰‡æ®µ</p>
                    <p>å‡åŒ€äº¤å‰ï¼šæ¯ä¸ªåŸºå› ä½ä»¥ä¸€å®šæ¦‚ç‡æ¥è‡ªä»»ä¸€çˆ¶ä»£</p>
                </div>
                
                <div class="info-box">
                    <h3>å˜å¼‚æ“ä½œè¯´æ˜</h3>
                    <p>å˜å¼‚æ˜¯é—ä¼ ç®—æ³•ä¸­å¼•å…¥éšæœºæ€§çš„å…³é”®æ“ä½œï¼Œå¢åŠ ç§ç¾¤å¤šæ ·æ€§</p>
                    <p>å˜å¼‚ç‡é€šå¸¸è®¾ä¸º0.01-0.1ä¹‹é—´</p>
                </div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color binary-legend"></div>
                        <span>äºŒè¿›åˆ¶</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color permutation-legend"></div>
                        <span>æ’åˆ—</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color real-legend"></div>
                        <span>å®æ•°</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color crossover-legend"></div>
                        <span>äº¤å‰ç‚¹</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color mutation-legend"></div>
                        <span>å˜å¼‚ç‚¹</span>
                    </div>
                </div>
            </div>
            
            <div class="visualization-area">
                <h2 style="text-align: center; margin-bottom: 20px;">å¯è§†åŒ–åŒºåŸŸ</h2>
                
                <div class="current-state" id="currentState">
                    ğŸš€ é€‰æ‹©ç¼–ç æ–¹å¼å¹¶ç”Ÿæˆçˆ¶ä»£å¼€å§‹å­¦ä¹ 
                </div>
                
                <div class="step-indicator">
                    <div class="step" id="step1">çˆ¶ä»£ç”Ÿæˆ</div>
                    <div class="step" id="step2">äº¤å‰æ“ä½œ</div>
                    <div class="step" id="step3">å˜å¼‚æ“ä½œ</div>
                </div>
                
                <div id="visualizationContent">
                    <div style="text-align: center; color: #aaa; padding: 50px;">
                        <h3>ç­‰å¾…æ“ä½œ...</h3>
                        <p>ç‚¹å‡»"ç”Ÿæˆçˆ¶ä»£"å¼€å§‹</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let parents = [];
        let offspring = [];
        let currentStep = 0;
        
        // æŸ“è‰²ä½“ç±»
        class Chromosome {
            constructor(genes) {
                this.genes = genes;
                this.id = Math.random().toString(36).substr(2, 6);
            }
        }
        
        // ç”Ÿæˆçˆ¶ä»£
        function generateParents() {
            const encodingType = document.getElementById('encodingType').value;
            parents = [];
            
            for (let i = 0; i < 2; i++) {
                let genes = [];
                
                switch (encodingType) {
                    case 'binary':
                        for (let j = 0; j < 8; j++) {
                            genes.push(Math.random() > 0.5 ? 1 : 0);
                        }
                        break;
                    case 'permutation':
                        genes = Array.from({length: 8}, (_, i) => i + 1);
                        // Fisher-Yates shuffle
                        for (let j = genes.length - 1; j > 0; j--) {
                            const k = Math.floor(Math.random() * (j + 1));
                            [genes[j], genes[k]] = [genes[k], genes[j]];
                        }
                        break;
                    case 'real':
                        for (let j = 0; j < 8; j++) {
                            genes.push(parseFloat((Math.random() * 10).toFixed(2)));
                        }
                        break;
                }
                
                parents.push(new Chromosome(genes));
            }
            
            currentStep = 1;
            updateVisualization();
            updateStepIndicator();
            document.getElementById('currentState').textContent = 'âœ… ä¸¤ä¸ªçˆ¶ä»£ä¸ªä½“å·²ç”Ÿæˆ';
        }
        
        // æ‰§è¡Œäº¤å‰
        function performCrossover() {
            if (parents.length < 2) {
                alert("è¯·å…ˆç”Ÿæˆçˆ¶ä»£ä¸ªä½“ï¼");
                return;
            }
            
            const crossoverType = document.getElementById('crossoverType').value;
            const parent1 = parents[0];
            const parent2 = parents[1];
            
            let offspring1, offspring2;
            let crossoverPoints = [];
            
            switch (crossoverType) {
                case 'single':
                    const point1 = Math.floor(Math.random() * parent1.genes.length);
                    crossoverPoints = [point1];
                    offspring1 = new Chromosome([
                        ...parent1.genes.slice(0, point1),
                        ...parent2.genes.slice(point1)
                    ]);
                    offspring2 = new Chromosome([
                        ...parent2.genes.slice(0, point1),
                        ...parent1.genes.slice(point1)
                    ]);
                    break;
                    
                case 'double':
                    let point2a = Math.floor(Math.random() * parent1.genes.length);
                    let point2b = Math.floor(Math.random() * parent1.genes.length);
                    if (point2a > point2b) [point2a, point2b] = [point2b, point2a];
                    crossoverPoints = [point2a, point2b];
                    
                    offspring1 = new Chromosome([
                        ...parent1.genes.slice(0, point2a),
                        ...parent2.genes.slice(point2a, point2b),
                        ...parent1.genes.slice(point2b)
                    ]);
                    offspring2 = new Chromosome([
                        ...parent2.genes.slice(0, point2a),
                        ...parent1.genes.slice(point2a, point2b),
                        ...parent2.genes.slice(point2b)
                    ]);
                    break;
                    
                case 'uniform':
                    const mask = [];
                    for (let i = 0; i < parent1.genes.length; i++) {
                        mask.push(Math.random() > 0.5);
                    }
                    
                    offspring1 = new Chromosome(parent1.genes.map((gene, i) => 
                        mask[i] ? gene : parent2.genes[i]
                    ));
                    offspring2 = new Chromosome(parent2.genes.map((gene, i) => 
                        mask[i] ? gene : parent1.genes[i]
                    ));
                    break;
            }
            
            offspring = [offspring1, offspring2];
            currentStep = 2;
            updateVisualization();
            updateStepIndicator();
            document.getElementById('currentState').textContent = `âœ‚ï¸ ${getCrossoverName(crossoverType)}å®Œæˆï¼`;
        }
        
        // æ‰§è¡Œå˜å¼‚
        function performMutation() {
            if (offspring.length === 0) {
                alert("è¯·å…ˆæ‰§è¡Œäº¤å‰æ“ä½œï¼");
                return;
            }
            
            const encodingType = document.getElementById('encodingType').value;
            
            // å¯¹å­ä»£è¿›è¡Œå˜å¼‚
            for (let i = 0; i < offspring.length; i++) {
                for (let j = 0; j < offspring[i].genes.length; j++) {
                    // 10%çš„æ¦‚ç‡è¿›è¡Œå˜å¼‚
                    if (Math.random() < 0.1) {
                        switch (encodingType) {
                            case 'binary':
                                offspring[i].genes[j] = offspring[i].genes[j] === 0 ? 1 : 0;
                                break;
                            case 'permutation':
                                // æ‰¾åˆ°å¦ä¸€ä¸ªä½ç½®è¿›è¡Œäº¤æ¢
                                const swapIdx = Math.floor(Math.random() * offspring[i].genes.length);
                                [offspring[i].genes[j], offspring[i].genes[swapIdx]] = 
                                [offspring[i].genes[swapIdx], offspring[i].genes[j]];
                                break;
                            case 'real':
                                // å°å¹…æ”¹å˜æ•°å€¼
                                offspring[i].genes[j] += (Math.random() - 0.5) * 2;
                                if (offspring[i].genes[j] < 0) offspring[i].genes[j] = 0;
                                if (offspring[i].genes[j] > 10) offspring[i].genes[j] = 10;
                                break;
                        }
                    }
                }
            }
            
            currentStep = 3;
            updateVisualization();
            updateStepIndicator();
            document.getElementById('currentState').textContent = 'ğŸ² å˜å¼‚æ“ä½œå®Œæˆï¼';
        }
        
        // é‡ç½®
        function resetAll() {
            parents = [];
            offspring = [];
            currentStep = 0;
            updateVisualization();
            updateStepIndicator();
            document.getElementById('currentState').textContent = 'ğŸš€ é€‰æ‹©ç¼–ç æ–¹å¼å¹¶ç”Ÿæˆçˆ¶ä»£å¼€å§‹å­¦ä¹ ';
        }
        
        // æ›´æ–°å¯è§†åŒ–æ˜¾ç¤º
        function updateVisualization() {
            const content = document.getElementById('visualizationContent');
            
            if (parents.length === 0) {
                content.innerHTML = '<div style="text-align: center; color: #aaa; padding: 50px;"><h3>ç­‰å¾…æ“ä½œ...</h3><p>ç‚¹å‡»"ç”Ÿæˆçˆ¶ä»£"å¼€å§‹</p></div>';
                return;
            }
            
            let html = '';
            
            // æ˜¾ç¤ºçˆ¶ä»£
            html += '<div class="chromosome-container">';
            html += '<h3>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ çˆ¶ä»£ä¸ªä½“</h3>';
            
            parents.forEach((parent, idx) => {
                html += `<div style="margin: 10px 0;"><strong>çˆ¶ä»£ #${idx + 1}</strong></div>`;
                html += '<div class="chromosome">';
                
                parent.genes.forEach((gene, geneIdx) => {
                    let geneClass = `gene ${document.getElementById('encodingType').value} parent${idx + 1}`;
                    html += `<div class="${geneClass}">${typeof gene === 'number' ? gene.toFixed(2) : gene}</div>`;
                });
                
                html += '</div>';
            });
            
            html += '</div>';
            
            // æ˜¾ç¤ºäº¤å‰ç‚¹ï¼ˆå¦‚æœå·²æ‰§è¡Œäº¤å‰ï¼‰
            if (currentStep >= 2) {
                const crossoverType = document.getElementById('crossoverType').value;
                html += '<div class="chromosome-container">';
                html += `<h3>âœ‚ï¸ ${getCrossoverName(crossoverType)}ç»“æœ</h3>`;
                
                offspring.forEach((child, idx) => {
                    html += `<div style="margin: 10px 0;"><strong>å­ä»£ #${idx + 1}</strong></div>`;
                    html += '<div class="chromosome">';
                    
                    child.genes.forEach((gene, geneIdx) => {
                        let geneClass = `gene ${document.getElementById('encodingType').value} offspring`;
                        html += `<div class="${geneClass}">${typeof gene === 'number' ? gene.toFixed(2) : gene}</div>`;
                    });
                    
                    html += '</div>';
                });
                
                html += '</div>';
            }
            
            // æ˜¾ç¤ºå˜å¼‚ç»“æœï¼ˆå¦‚æœå·²æ‰§è¡Œå˜å¼‚ï¼‰
            if (currentStep >= 3) {
                html += '<div class="chromosome-container">';
                html += '<h3>ğŸ² å˜å¼‚åç»“æœ</h3>';
                
                offspring.forEach((child, idx) => {
                    html += `<div style="margin: 10px 0;"><strong>æœ€ç»ˆå­ä»£ #${idx + 1}</strong></div>`;
                    html += '<div class="chromosome">';
                    
                    child.genes.forEach((gene, geneIdx) => {
                        let geneClass = `gene ${document.getElementById('encodingType').value} offspring`;
                        // è¿™é‡Œå¯ä»¥æ·»åŠ å˜å¼‚ç‚¹çš„æ ‡è®°é€»è¾‘ï¼Œä½†ç®€åŒ–èµ·è§ä¸æ·»åŠ 
                        html += `<div class="${geneClass}">${typeof gene === 'number' ? gene.toFixed(2) : gene}</div>`;
                    });
                    
                    html += '</div>';
                });
                
                html += '</div>';
            }
            
            content.innerHTML = html;
        }
        
        // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
        function updateStepIndicator() {
            for (let i = 1; i <= 3; i++) {
                const step = document.getElementById(`step${i}`);
                step.classList.remove('active');
                if (i <= currentStep) {
                    step.classList.add('active');
                }
            }
        }
        
        // è·å–äº¤å‰æ“ä½œåç§°
        function getCrossoverName(type) {
            switch (type) {
                case 'single': return 'å•ç‚¹äº¤å‰';
                case 'double': return 'åŒç‚¹äº¤å‰';
                case 'uniform': return 'å‡åŒ€äº¤å‰';
                default: return 'äº¤å‰';
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–
            updateStepIndicator();
        });
    </script>
</body>
</html>
